import socket
import json

def load_known_services():
    with open("services.json", "r") as f:
        return json.load(f)

def banner_grab(ip, port):
    try:
        s = socket.socket()
        s.settimeout(1)
        s.connect((ip, port))
        banner = s.recv(1024).decode().strip()
        s.close()
        return banner
    except:
        return ""

def scan_target(ip):
    known_services = load_known_services()
    open_ports = []

    print(f"\n[*] Scanning {ip} for common ports...\n")
    for port in [21, 22, 23, 25, 80, 110, 139, 443, 445, 3306, 8080]:
        try:
            s = socket.socket()
            s.settimeout(0.5)
            s.connect((ip, port))
            s.close()
            open_ports.append(port)
            print(f"[+] Port {port} is OPEN")
            
            banner = banner_grab(ip, port)
            if banner:
                print(f"    ‚îî‚îÄ Banner: {banner}")
                for service, details in known_services.items():
                    if service in banner.lower():
                        print(f"    ‚ö†Ô∏è  Potential Match: {service}")
                        print(f"    ‚ÑπÔ∏è  Risk: {details['risk']}")
                        print(f"    üîó Ref: {details['reference']}")
        except:
            continue

if __name__ == "__main__":
    target_ip = input("Enter target IP address: ")
    scan_target(target_ip)
